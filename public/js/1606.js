"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1606],{82041:(t,e,a)=>{a.d(e,{Z:()=>o});var n=a(1519),r=a.n(n)()((function(t){return t[1]}));r.push([t.id,".v-input__slot{margin-bottom:0!important}",""]);const o=r},1606:(t,e,a)=>{a.r(e),a.d(e,{default:()=>v});var n=a(87757),r=a.n(n),o=a(9669),i=a.n(o);function s(t,e,a,n,r,o,i){try{var s=t[o](i),l=s.value}catch(t){return void a(t)}s.done?e(l):Promise.resolve(l).then(n,r)}function l(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var o=t.apply(e,a);function i(t){s(o,n,r,i,l,"next",t)}function l(t){s(o,n,r,i,l,"throw",t)}i(void 0)}))}}const d={data:function(){return{departmentsList:[],header:[{text:"Department Logo",value:"logo",align:"start"},{text:"Department Short Name",value:"name",align:"start"},{text:"Department Name",value:"description",align:"start"},{text:"Actions",sortable:!1}],type:null,valid:!0,dialog:!1,Deldialog:!1,rules:[function(t){return!!t||"Field is required"}],form:new Form({short_name:"",name:"",logo:null}),file:null,IsDeleting:!1,deleteIndex:null,deleteId:null,isUpdateId:null,isUpdateIndex:null,isAdding:!1,Logorules:[function(t){return!t||t.size<1e7||"Avatar size should be less than 10 MB!"}],isUploading:!1,old_logo_path:null}},methods:{fetchDeparmentList:function(){var t=this;i().get("/api/admin/department/all").then((function(e){t.departmentsList=e.data}))},addDepartment:function(){var t=this;return l(r().mark((function e(){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=new FormData).append("short_name",t.form.short_name),a.append("name",t.form.name),a.append("logo",t.file),i().post("/api/admin/department/add",a).then((function(e){1==e.data.success&&(t.departmentsList.push(e.data.new_data),t.dialog=!1,t.isAdding=!1,t.file=null,t.$refs.form.reset())})).catch((function(e){t.isAdding=!1,t.file=null,t.toastError("Something went wrong, ",e.response.data.error)}));case 5:case"end":return e.stop()}}),e)})))()},validate:function(){this.isAdding=!0,this.$refs.form.validate()?"add"==this.type?this.addDepartment():"edit"==this.type&&this.UpdateDepartmentDetails():this.isAdding=!1},deleteDepartment:function(){var t=this;return l(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i().delete("/api/admin/department/delete/"+t.deleteId).then((function(e){1==e.data.success&&(t.departmentsList.splice(t.deleteIndex,1),t.Deldialog=!1)}));case 1:case"end":return e.stop()}}),e)})))()},OpendepartmentDialog:function(t,e){this.form.name=t.name,this.form.logo=t.logo,this.old_logo_path=t.logo,this.form.short_name=t.short_name,this.isUpdateId=t.id,this.isUpdateIndex=e,this.type="edit",this.dialog=!0},UpdateDepartmentDetails:function(){var t=this;return l(r().mark((function e(){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=new FormData).append("short_name",t.form.short_name),a.append("name",t.form.name),a.append("old_logo_path",t.old_logo_path),a.append("logo",t.file),i().post("/api/admin/department/update/"+t.isUpdateId,a).then((function(e){1==e.data.success&&(t.departmentsList[t.isUpdateIndex].name=t.form.name,t.departmentsList[t.isUpdateIndex].short_name=t.form.short_name,t.departmentsList[t.isUpdateIndex].logo=e.data.path,t.isAdding=!1,t.dialog=!1,t.file=null,t.$refs.form.reset())}));case 6:case"end":return e.stop()}}),e)})))()},onFileChange:function(t){this.form.logo=URL.createObjectURL(t)},clearData:function(){this.dialog=!1,this.form.logo=null,this.$refs.form.reset()}},mounted:function(){this.fetchDeparmentList()}};var c=a(72446),m=a.n(c),p=a(82041),u={insert:"head",singleton:!1};m()(p.Z,u);p.Z.locals;const v=(0,a(51900).Z)(d,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pt-2"},[a("h2",[t._v("\n        Manage Departments\n    ")]),t._v(" "),a("v-row",{staticClass:"pt-2"},[a("v-col",{attrs:{cols:"12"}},[a("v-card",{attrs:{elevation:"2"}},[a("v-card-title",[a("v-btn",{staticClass:"white--text ml-auto",attrs:{color:"primary",small:"",align:"right"},on:{click:function(e){t.dialog=!0,t.type="add"}}},[t._v("\n                        Department\n                        "),a("v-icon",{attrs:{right:"",dark:""}},[t._v("\n                            mdi-plus\n                        ")])],1)],1),t._v(" "),a("v-divider"),t._v(" "),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.header,items:t.departmentsList,"items-per-page":5},scopedSlots:t._u([{key:"body",fn:function(e){var n=e.items;return[a("tbody",t._l(n,(function(e,n){return a("tr",{key:e.id},[a("td",{staticClass:"text-center"},[a("v-img",{attrs:{"max-width":"60","max-height":"60",src:e.logo}})],1),t._v(" "),a("td",[t._v(t._s(e.short_name))]),t._v(" "),a("td",[t._v(t._s(e.name))]),t._v(" "),a("td",{staticStyle:{width:"8%"}},[a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(r){var o=r.on,i=r.attrs;return[a("v-btn",t._g(t._b({attrs:{text:"",icon:""},on:{click:function(a){return t.OpendepartmentDialog(e,n)}}},"v-btn",i,!1),o),[a("v-icon",{attrs:{color:"blue"}},[t._v("mdi-pencil-box-multiple-outline")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Edit")])]),t._v(" "),a("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(r){var o=r.on,i=r.attrs;return[a("v-btn",t._g(t._b({attrs:{text:"",icon:""},on:{click:function(a){t.Deldialog=!0,t.deleteIndex=n,t.deleteId=e.id}}},"v-btn",i,!1),o),[a("v-icon",{attrs:{color:"red"}},[t._v("mdi-delete")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Delete")])])],1)])})),0)]}}])})],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{persistent:"",width:"500"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-form",{ref:"form",staticClass:"text-center ",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-card-title",{},[t._v("\n                "+t._s("add"==t.type?"Add Department":"Update Department")+"\n            ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-container",{staticClass:"mb-0 pb-0"},[a("v-row",{staticClass:"pa-5"},[a("v-col",{staticClass:"ma-0 pa-0 text-center",attrs:{cols:"12",md:"12"}},[a("v-avatar",{attrs:{tile:null!=t.form.logo&&""!=t.form.logo,size:"130"},on:{click:function(e){return t.$refs.refdepartment.$refs.input.click()}}},[a("v-hover",{scopedSlots:t._u([{key:"default",fn:function(e){var n=e.hover;return[a("div",[a("v-avatar",{staticStyle:{cursor:"pointer"},attrs:{tile:null!=t.form.logo&&""!=t.form.logo,color:"add"==t.type?"#0D8ABC":"",size:"130"}},[null==t.form.logo||""==t.form.logo?a("v-icon",{staticStyle:{"font-size":"4rem"},attrs:{color:"white"}},[t._v("mdi-cloud-upload-outline")]):a("v-img",{attrs:{contain:"",alt:"Proflie",src:t.form.logo}},[t.isUploading?a("v-row",{staticClass:"fill-height ma-0",attrs:{align:"center",justify:"center"}},[a("v-progress-circular",{attrs:{indeterminate:"",color:"grey lighten-5"}})],1):t._e()],1)],1),t._v(" "),a("v-fade-transition",[n?a("v-overlay",{staticStyle:{cursor:"pointer"},attrs:{absolute:"",color:"#212121"}},[a("div",{},[a("v-icon",{attrs:{small:""}},[t._v("mdi-camera")]),t._v(" "+t._s(t.isUploading?"Uploading":"Upload")+" ")],1)]):t._e()],1)],1)]}}])})],1),t._v(" "),a("v-file-input",{ref:"refdepartment",staticClass:"d-none",attrs:{outlined:"",rules:t.Logorules,"prepend-icon":"",accept:"image/png, image/jpeg, image/bmp","prepend-inner-icon":"mdi-camera",label:"Department Logo"},on:{change:t.onFileChange},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}})],1),t._v(" "),a("v-col",{staticClass:"ma-0 pa-0 mb-5",attrs:{cols:"12",md:"12"}},[a("h3",[t._v(" Department Logo")])]),t._v(" "),a("v-col",{staticClass:"ma-0 pa-0 mb-1",attrs:{cols:"12",md:"12"}},[a("HasError",{staticClass:"error--text",attrs:{form:t.form,field:"short_name"}}),t._v(" "),a("v-textarea",{staticClass:"mb-0 pb-0",attrs:{type:"text",rows:"1",name:"name",label:"Short Name",placeholder:"Eg. CCSICT, COC, COE , etc","auto-grow":"",outlined:"",rules:t.rules},model:{value:t.form.short_name,callback:function(e){t.$set(t.form,"short_name",e)},expression:"form.short_name"}})],1),t._v(" "),a("v-col",{staticClass:"ma-0 pa-0 mb-1",attrs:{cols:"12",md:"12"}},[a("HasError",{staticClass:"error--text",attrs:{form:t.form,field:"name"}}),t._v(" "),a("v-textarea",{staticClass:"mb-0 pb-0",attrs:{type:"text",rows:"1",name:"name",rules:t.rules,label:"Department Name","auto-grow":"",outlined:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{text:""},on:{click:function(e){return t.clearData()}}},[t._v("Cancel")]),t._v(" "),a("v-btn",{attrs:{loading:t.isAdding,text:"",color:"primary"},on:{click:function(e){return t.validate()}}},[t._v("\n                        "+t._s("add"==this.type?"Add":"Update"))])],1)],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:t.Deldialog,callback:function(e){t.Deldialog=e},expression:"Deldialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[t._v("\n                Are you sure you want to delete this?\n            ")]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{text:""},on:{click:function(e){t.Deldialog=!1}}},[t._v("\n                    No\n                ")]),t._v(" "),a("v-btn",{attrs:{loading:t.IsDeleting,color:"primary",text:""},on:{click:function(e){return t.deleteDepartment()}}},[t._v("\n                    Yes\n                ")])],1)],1)],1)],1)}),[],!1,null,null,null).exports}}]);