"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8942],{4798:(t,e,n)=>{n.d(e,{Z:()=>a});var i=n(1519),o=n.n(i)()((function(t){return t[1]}));o.push([t.id,".area-text[data-v-42cf5597]{border-color:transparent;border-style:none;overflow:auto}.text-field-transparent .v-input__slot[data-v-42cf5597]{background:transparent!important}",""]);const a=o},8942:(t,e,n)=>{n.r(e),n.d(e,{default:()=>u});var i=n(7757),o=n.n(i),a=n(2239);function s(t,e,n,i,o,a,s){try{var r=t[a](s),c=r.value}catch(t){return void n(t)}r.done?e(c):Promise.resolve(c).then(i,o)}function r(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){s(a,i,o,r,c,"next",t)}function c(t){s(a,i,o,r,c,"throw",t)}r(void 0)}))}}const c={props:["UserDetails","postDetails"],data:function(){return{CommentList:[],comment:"",data:{},showComment:!1,isEditing:!1,idEditing_id:null,UpdateComment:"",current_count:0,current_page:null,last_page:null,isloading:!1,isLoaded:!1,readMore:[],readMore_id:null,AreaHeight:[]}},methods:{format_date:function(t){if(t)return(0,a.Z)(String(t)).format("dddd,  h:mm a")},CheckCommentLoad:function(){var t=this;return r(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showComment?(t.CommentList=[],t.showComment=!t.showComment):(t.getComments(),t.showComment=!t.showComment);case 1:case"end":return e.stop()}}),e)})))()},getCount:function(){var t=this;return r(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:axios.get("/api/post/allcomment/"+t.postDetails.post_id).then((function(e){t.postDetails.comment_count=e.data.total}));case 1:case"end":return e.stop()}}),e)})))()},getComments:function(){var t=this;return r(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:0!=t.postDetails.comment_count&&(t.isloading=!0,axios.get("/api/post/allcomment/"+t.postDetails.post_id).then((function(e){t.CommentList=e.data.data,t.last_page=e.data.last_page,t.current_count=t.CommentList.length,t.current_page=1,t.CommentList.sort((function(t,e){return t.id-e.id})),t.CommentList.forEach((function(e){t.readMore.push({id:e.id,isLongText:!1,IsreadMore:!1})})),t.isloading=!1,t.postDetails.comment_count=e.data.total,setTimeout((function(){return t.checkContainerHeight()}),1e3)})));case 1:case"end":return e.stop()}}),e)})))()},singleCheck:function(t,e){var n=this.$refs[t][0].clientHeight;this.$vuetify.breakpoint.mdAndUp?this.readMore[e].IsreadMore=n>215:this.readMore[e].IsreadMore=n>160},checkContainerHeight:function(){var t=this,e=0;this.readMore.forEach((function(n){var i=t.postDetails.id+"commentContainer"+e,o=t.$refs[i][0].clientHeight;t.$vuetify.breakpoint.mdAndUp?n.IsreadMore=o>215:n.IsreadMore=o>160,e++}))},loadMoreComment:function(){var t=this;return r(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.current_page!=t.last_page&&(t.current_page++,axios.get("/api/post/allcomment/"+t.postDetails.post_id+"?page="+t.current_page).then((function(e){e.data.data.forEach((function(e){t.CommentList.push(e)})),t.last_page=e.data.last_page,t.current_count=t.CommentList.length,console.log(t.current_page),t.CommentList.sort((function(t,e){return t.id-e.id})),t.CommentList.forEach((function(e){t.readMore.push({id:e.id,isLongText:!1,IsreadMore:!1})})),t.postDetails.comment_count=e.data.total,setTimeout((function(){return t.checkContainerHeight()}),1e3)})));case 1:case"end":return e.stop()}}),e)})))()},LoadLessComment:function(){var t=this;return r(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.getComments();case 1:case"end":return e.stop()}}),e)})))()},addComment:function(){var t=this;return r(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showComment=!0,t.postDetails.isCommented=!0,t.data.content=t.comment,t.data.course_id=t.$route.params.id,t.data.post_id=t.postDetails.post_id,axios.post("/api/post/comment/insert",t.data).then((function(e){t.clearComment(),t.getComments(),t.getCount()}));case 6:case"end":return e.stop()}}),e)})))()},clearComment:function(){this.comment=""},RemoveComment:function(t,e){var n=this;return r(o().mark((function i(){return o().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:axios.delete("/api/post/comment/remove/"+t).then((function(){n.CommentList.splice(e,1),n.postDetails.comment_count=0!=n.postDetails.comment_count?n.postDetails.comment_count-1:0,n.current_count=0!=n.current_count?n.current_count-1:0}));case 1:case"end":return i.stop()}}),i)})))()},UpdateCommentData:function(t){var e=this;return r(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:axios.put("/api/post/comment/update/"+e.idEditing_id,{comment:e.UpdateComment}).then((function(){e.CommentList[t].content=e.UpdateComment,e.UpdateComment="",e.idEditing_id=null}));case 1:case"end":return n.stop()}}),n)})))()},LikePost:function(t,e){var n=this;return r(o().mark((function i(){return o().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:e?axios.delete("/api/post/like/delete/"+t).then((function(){n.postDetails.liked=!1,n.postDetails.likes_count=0!=n.postDetails.likes_count?n.postDetails.likes_count-=1:0})):axios.post("/api/post/like",{post_id:t}).then((function(){n.postDetails.liked=!0,n.postDetails.likes_count+=1}));case 1:case"end":return i.stop()}}),i)})))()}}};var l=n(2446),m=n.n(l),d=n(4798),p={insert:"head",singleton:!1};m()(d.Z,p);d.Z.locals;const u=(0,n(1900).Z)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-container",{class:t.$vuetify.breakpoint.xs?"mt-3 text-center pl-5 pr-3 mb-2 d-inline-flex justify-space-between":"mt-3 text-right pl-5 pr-3 mb-2 d-inline-flex"},[n("v-btn",{attrs:{rounded:"",text:""},on:{click:function(e){return t.LikePost(t.postDetails.post_id,t.postDetails.liked)}}},[n("v-icon",{staticClass:"mr-1",attrs:{color:t.postDetails.liked?"blue":""}},[t._v("  "+t._s(t.postDetails.liked?"mdi-thumb-up":"mdi-thumb-up-outline")+" ")]),t._v("\r\n            "+t._s(t.postDetails.likes_count+" like")+"\r\n        ")],1),t._v(" "),n("v-btn",{attrs:{rounded:"",text:""},on:{click:t.CheckCommentLoad}},[n("v-icon",{staticClass:"mr-1",attrs:{color:t.postDetails.isCommented?"blue":""}},[t._v("mdi-comment")]),t._v("\r\n           "+t._s(t.postDetails.comment_count+" Comments")+"\r\n        ")],1)],1),t._v(" "),n("v-row",{staticClass:"pl-5 pr-5"},[n("v-divider")],1),t._v(" "),n("transition",{attrs:{transition:"v-expand-transition"}},[t.showComment?n("div",{staticClass:"mt-6 mb-0 pb-0"},[t.isloading?n("div",{staticClass:"mt-10"},[t.isloading?n("vue-element-loading",{attrs:{active:t.isloading,duration:"0.7",color:"#EF6C00",spinner:"line-scale"}}):t._e()],1):t._e(),t._v(" "),n("div",{staticClass:"pl-5 pr-5"},[0!=t.postDetails.comment_count?n("v-row",{staticClass:"mt-0 mb-0"},[n("v-col",{staticClass:"text-left",attrs:{cols:"8"}},[t.current_count<t.postDetails.comment_count&&this.last_page!=this.current_page?n("a",{staticStyle:{"text-decoration":"none","font-size":"0.8rem"},attrs:{href:""},on:{click:function(e){return e.preventDefault(),t.loadMoreComment()}}},[t._v("View previous comments")]):t._e(),t._v(" "),this.last_page==this.current_page&&t.postDetails.comment_count>5?n("a",{staticStyle:{"text-decoration":"none","font-size":"0.8rem"},attrs:{href:""},on:{click:function(e){return e.preventDefault(),t.LoadLessComment()}}},[t._v("Show less comments")]):t._e()]),t._v(" "),n("v-col",{staticClass:"text-right",attrs:{cols:"4"}},[n("small",[t._v("\r\n                    "+t._s(t.current_count)+" of "+t._s(t.postDetails.comment_count)+"\r\n                ")])])],1):t._e()],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isloading,expression:"!isloading"}]},t._l(t.CommentList,(function(e,i){return n("v-container",{key:e.id,class:t.$vuetify.breakpoint.mdAndUp?"d-inline-flex ml-1 pr-4 pb-2 shrink rounded-lg":"d-inline-flex pl-6 pr-4 pb-2 shrink rounded-lg",attrs:{fluid:""}},[t.idEditing_id!=e.id?n("v-avatar",{class:t.isEditing&&t.idEditing_id==e.id?"mt-1":"",attrs:{color:"grey",size:t.$vuetify.breakpoint.mdAndUp?"40":"30"}},[n("v-img",{staticClass:"rounded-circle",attrs:{src:null==e.profile_pic||""==e.profile_pic?"https://ui-avatars.com/api/?background=0D8ABC&color=fff&name="+e.name:e.profile_pic}})],1):t._e(),t._v(" "),t.isEditing&&t.idEditing_id==e.id?n("v-btn",{staticClass:"mt-2",attrs:{icon:"",small:""},on:{click:function(e){t.isEditing=!1,t.idEditing_id=null}}},[n("v-icon",[t._v("\r\n                    mdi-close\r\n                ")])],1):t._e(),t._v(" "),n("div",{ref:t.postDetails.id+"commentContainer"+i,refInFor:!0,staticClass:"ma-0 pa-0",staticStyle:{width:"100%"},on:{mouseover:function(e){return t.singleCheck(t.postDetails.id+"commentContainer"+i,i)}}},[n("v-alert",{staticClass:"ma-0 pa-0 ml-2 rounded-xl",attrs:{color:t.isEditing&&t.idEditing_id==e.id?"":"#F5F5F5"}},[n("p",[n("v-row",{staticClass:"ma-0"},[n("v-col",{staticClass:"mb-0 pb-0",attrs:{cols:"12"}},[n("v-row",[n("v-col",{staticClass:"text-left mb-0 pb-0",attrs:{cols:"8"}},[n("div",{staticClass:"font-weight-medium mb-0 pb-0"},[t._v(t._s(e.name))]),t._v(" "),n("div",{staticClass:"mt-0 pt-0 mb-2",staticStyle:{"font-size":"12px"}},[t._v(t._s(t.format_date(e.created_at)))])]),t._v(" "),n("v-col",{staticClass:"text-right mb-0 pb-0",attrs:{cols:"4"}},[n("div",[e.u_id!=t.UserDetails.id&&"Teacher"!=t.UserDetails.role||t.idEditing_id==e.id?t._e():n("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,o=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",o,!1),i),[n("v-icon",[t._v("mdi-dots-vertical")])],1)]}}],null,!0)},[t._v(" "),n("v-list",{attrs:{"pa-0":"","ma-0":""}},[n("v-list-item",{attrs:{"ma-0":"","pa-0":""}},[n("v-list-item-title",[n("v-btn",{attrs:{text:""},on:{click:function(n){t.UpdateComment=e.content,t.isEditing=!0,t.idEditing_id=e.id}}},[t._v("Edit")])],1)],1),t._v(" "),n("v-list-item",{attrs:{"ma-0":"","pa-0":""}},[n("v-list-item-title",[n("v-btn",{attrs:{text:""},on:{click:function(n){return t.RemoveComment(e.id,i)}}},[t._v("Remove")])],1)],1)],1)],1)],1)]),t._v(" "),n("v-col",{staticClass:"mb-0 pb-0 mt-0 pt-0 pl-0 pr-0",attrs:{cols:"12"}},[n("v-lazy",{staticClass:"ml-0 pl-0",attrs:{transition:""}},[t.isEditing&&t.idEditing_id==e.id?t._e():n("v-textarea",{staticClass:"mt-0 pt-0 ml-0 pl-0 area-text text-field-transparent",style:t.$vuetify.breakpoint.mdAndUp?t.readMore[i].isLongText?"line-height:1.5;font-size:0.95rem;":"line-height:1.5;font-size:0.95rem;max-height:160px;overflow:hidden":t.readMore[i].isLongText?"line-height:1.5;font-size:0.9rem;background-color:transparent":"line-height:1.5;font-size:0.9rem;background-color:transparent;max-height:120px",attrs:{rounded:"",readonly:"","hide-details":"",flat:"",rows:"1","auto-grow":"",type:"text"},model:{value:e.content,callback:function(n){t.$set(e,"content",n)},expression:"item.content"}}),t._v(" "),t.readMore[i].IsreadMore?n("div",{staticClass:"text-right"},[t.readMore[i].isLongText?t._e():n("a",{staticClass:"mr-5",staticStyle:{"text-decoration":"none","font-size":"12px"},attrs:{href:""},on:{click:function(e){e.preventDefault(),t.readMore[i].isLongText=!0}}},[t._v("Read more..")]),t._v(" "),t.readMore[i].isLongText?n("a",{staticClass:"mr-5",staticStyle:{"text-decoration":"none","font-size":"12px"},attrs:{href:""},on:{click:function(e){e.preventDefault(),t.readMore[i].isLongText=!1}}},[t._v("Read less..")]):t._e()]):t._e()],1),t._v(" "),n("v-lazy",{attrs:{transition:""}},[t.isEditing&&t.idEditing_id==e.id?n("v-textarea",{class:t.$vuetify.breakpoint.mdAndUp?"":"text-caption",attrs:{"append-outer-icon":"mdi-send","prepend-avatar":"mdi-emoticon-dead",filled:"",rounded:"","hide-details":"",dense:"",rows:"1","auto-grow":"","clear-icon":"mdi-close-circle",clearable:"",placeholder:"Comment",type:"text"},on:{"click:append-outer":function(e){return t.UpdateCommentData(i)},"click:clear":function(e){t.UpdateComment=""}},model:{value:t.UpdateComment,callback:function(e){t.UpdateComment=e},expression:"UpdateComment"}}):t._e()],1)],1)],1)],1)],1)],1)])],1)],1)})),1)]):t._e()]),t._v(" "),n("v-row",{staticClass:"pa-3 pt-0 mt-0 mb-0 pb-0"},[n("v-col",{staticClass:"ma-0 pa-0",attrs:{cols:"12"}},[n("v-list",{staticClass:"mb-0 pb-0 mt-0 pt-0 "},[n("v-list-item",{staticClass:"mb-0 pb-0"},[t.$vuetify.breakpoint.mdAndUp?n("v-list-item-avatar",{staticClass:"mt-0 pt-0",attrs:{color:"secondary"}},[n("v-img",{attrs:{src:null==t.UserDetails.profile_pic||""==t.UserDetails.profile_pic?"https://ui-avatars.com/api/?background=0D8ABC&color=fff&name="+t.UserDetails.firstName+" "+t.UserDetails.lastName:t.UserDetails.profile_pic}})],1):t._e(),t._v(" "),n("v-list-item-content",{staticClass:"ma-0 pa-0"},[n("v-list-item-title",[n("v-textarea",{staticClass:"text-caption pl-0 mt-5",attrs:{"append-outer-icon":"mdi-send","prepend-avatar":"mdi-emoticon-dead",filled:"",rows:"1","auto-grow":"","hid-details":"",rounded:"",dense:"","clear-icon":"mdi-close-circle",clearable:"",placeholder:"Comment",type:"text"},on:{"click:append-outer":t.addComment,"click:clear":t.clearComment},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}})],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,"42cf5597",null).exports}}]);