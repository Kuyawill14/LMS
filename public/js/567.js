"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[567],{3349:(t,e,n)=>{n.d(e,{Z:()=>r});var s=n(1519),i=n.n(s)()((function(t){return t[1]}));i.push([t.id,".pannel-btn{position:absolute;right:47px;top:15px;z-index:100}.v-expansion-panel-content__wrap{padding:0!important}.course_content_header{align-items:center;display:flex}",""]);const r=i},8015:(t,e,n)=>{n.d(e,{Z:()=>r});var s=n(1519),i=n.n(s)()((function(t){return t[1]}));i.push([t.id,".v-list-item--disabled[data-v-59a49615]{background:#f6f6f6}",""]);const r=i},567:(t,e,n)=>{n.r(e),n.d(e,{default:()=>v});var s=n(7757),i=n.n(s);function r(t,e,n,s,i,r,o){try{var u=t[r](o),d=u.value}catch(t){return void n(t)}u.done?e(d):Promise.resolve(d).then(s,i)}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const d={props:["role","expand"],components:{},data:function(){return{click_id:null,loading:!0,temp_id:null,showLecture:!1,addLink:!1,showClasswork:!1,subModuleForm:{},mainModule_id:"",mainModule:[],studentSubModuleProgress:[],studentSubModuleProgressForm:{},timespent:0,time:!1,updateTime:!1,percentage:0,firstLoad:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},(0,n(629).Se)(["getmain_module","getSub_module","getAll_sub_module","getStudentModuleProgress"])),methods:{subModuleClick:function(t,e,n,s,i){t||"Teacher"==this.role?(this.setTimeSpent(e,n,i),this.passToMainComponent(this.getSub_module(e),n),this.addSubStudentProgress(e,n,s,i)):this.toastInfo("Module not available, The instructor still not yet publish this module.")},passToMainComponent:function(t,e){var n=t.find((function(t){return t.id===e}));this.$emit("subModule",n)},student_sub_module_progress:function(t){},getCount:function(t,e){for(var n=0,s=this.getSub_module(e),i=0;i<s.length;i++)for(var r=0;r<t.length;r++)void 0!==t[r]&&void 0!==s[i]&&t[r].sub_module_id==s[i].id&&t[r].time_spent>=s[i].required_time&&n++;return n},addSubStudentProgress:function(t,e,n){var s=this;"Student"==this.role&&(this.tempSubId=e,this.studentSubModuleProgressForm.main_module_id=t,this.studentSubModuleProgressForm.sub_module_id=e,this.studentSubModuleProgressForm.type=n,this.studentSubModuleProgressForm.course_id=this.$route.params.id,axios.post("/api/student_sub_module/insert",{studentProgress:this.studentSubModuleProgressForm}).then((function(t){s.$store.dispatch("studentmodule_progress",s.$route.params.id),s.fetchStudentModuleProgress()})))},checkTimeSpent:function(t,e,n){for(var s=!1,i=0;i<t.length;i++)t[i].sub_module_id==e.id&&t[i].time_spent>=n&&(s=!0);return s},fetchClass:function(){this.$store.dispatch("fetchClassList").then((function(){}))},getTimeSpent:function(t,e){for(var n=0;n<t.length;n++)if(t[n].sub_module_id==e)return t[n].time_spent;return 0},convertTime:function(t,e){if(-1==e){var n=this.getTimeSpent(this.studentSubModuleProgress,t);return void 0===n&&(n=0),new Date(1e3*parseInt(n)).toISOString().substr(11,8)}return new Date(1e3*parseInt(e)).toISOString().substr(11,8)},setTimeSpent:function(t,e,n){var s=this;"Student"==this.role&&(clearInterval(this.ctrTime),clearInterval(this.updateTime),this.timespent=this.getTimeSpent(this.studentSubModuleProgress,e),this.ctrTime=!1,this.updateTime=!1,this.ctrTime=setInterval((function(){s.timespent++,s.time=!0}),1e3),this.updateTime=setInterval((function(){s.updateStudentTimeProgress(t,e,s.timespent)}),3e4))},updateStudentTimeProgress:function(t,e,n){var s=this,i={};i.main_module_id=t,i.sub_module_id=e,i.time_spent=n;axios.post("/api/student_sub_module/updatetime",{studentProgress:i}).then((function(t){for(var e=t.data.studentProgress,n=0;n<s.studentSubModuleProgress.length;n++)if(s.studentSubModuleProgress[n].sub_module_id==e.sub_module_id){s.studentSubModuleProgress[n].time_spent=e.time_spent,s.$store.dispatch("studentmodule_progress",s.$route.params.id);break}}))},fetchStudentModuleProgress:function(){var t=this;axios.get("/api/student_sub_module/all/".concat(this.$route.params.id)).then((function(e){t.studentSubModuleProgress=e.data}))}},mounted:function(){var t,e=this;return(t=i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.fetchStudentModuleProgress(),e.$store.dispatch("fetchMainModule",e.$route.params.id),e.$store.dispatch("studentmodule_progress",e.$route.params.id),e.loading=!1,setTimeout((function(){e.firstLoad=!1}),5e3);case 5:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(s,i){var o=t.apply(e,n);function u(t){r(o,s,i,u,d,"next",t)}function d(t){r(o,s,i,u,d,"throw",t)}u(void 0)}))})()},created:function(){this.firstLoad=!0},beforeDestroy:function(){clearInterval(this.ctrTime),clearInterval(this.updateTime)}};var a=n(2446),l=n.n(a),c=n(3349),m={insert:"head",singleton:!1};l()(c.Z,m);c.Z.locals;var p=n(8015),_={insert:"head",singleton:!1};l()(p.Z,_);p.Z.locals;const v=(0,n(1900).Z)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{width:"100%"}},[n("v-card",{staticClass:"mb-2"},[n("v-list-item",[n("v-list-item-content",[n("v-list-item-title",{staticClass:"course_content_header"},[t._v("\n                    Modules Content\n                    "),n("v-spacer"),t._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[n("v-progress-circular",t._g(t._b({staticClass:"float-right",attrs:{value:t.getStudentModuleProgress.percentage,rotate:-90,size:40,color:"green lighten-2"}},"v-progress-circular",i,!1),s),[n("span",[t._v(" "+t._s(t.getStudentModuleProgress.percentage))])])]}}])},[t._v(" "),n("span",[t._v(t._s(t.getStudentModuleProgress.completed)+" of\n                            "+t._s(t.getStudentModuleProgress.submodules_count)+" complete")])])],1)],1),t._v(" "),t.expand?n("v-list-item-action",[n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.$emit("listClose")}}},[n("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("mdi-close")])],1)],1):t._e()],1)],1),t._v(" "),n("v-expansion-panels",{staticStyle:{"margin-left":"1px"},attrs:{focusable:""}},t._l(t.getmain_module,(function(e,s){return n("v-expansion-panel",{key:"module"+s},[n("v-expansion-panel-header",[n("span",{staticStyle:{"font-size":"1.0rem"}},[n("v-icon",{staticStyle:{"font-size":"1.0rem"}},[t._v("\n                        mdi-folder\n                    ")]),t._v("\n                    "+t._s(e.module_name)+" "),n("br"),t._v("\n                    "+t._s(t.getCount(t.studentSubModuleProgress,e.id)+" / "+t.getSub_module(e.id).length)+"\n\n\n                ")],1)]),t._v(" "),n("v-expansion-panel-content",{staticClass:"pa-0"},t._l(t.getSub_module(e.id),(function(s,i){return n("v-list-item",{key:"Submodule"+i,staticClass:"pl-8",attrs:{link:"",disabled:t.click_id==s.id},on:{click:function(n){t.click_id=s.id,t.subModuleClick(e.isPublished,e.id,s.id,s.type,t.studentSubModuleProgress)}}},[n("v-list-item-avatar",[n("v-icon",{staticClass:"grey lighten-1",attrs:{dark:""}},[t._v("\n                            mdi-folder\n                        ")])],1),t._v(" "),n("v-list-item-content",[n("v-list-item-title",[t._v(" "+t._s(s.sub_module_name))]),t._v(" "),n("v-list-item-subtitle",[t._v(" "+t._s(s.type))]),t._v(" "),n("v-list-item-subtitle",[t._v(" Time spent:\n                            "+t._s(t.convertTime(s.id,-1))+"\n\n                        ")]),t._v(" "),n("v-list-item-subtitle",[t._v(" Required time:\n                            "+t._s(t.convertTime(-1,s.required_time))+"\n\n                        ")])],1),t._v(" "),n("v-list-item-action",[n("v-icon",{attrs:{color:t.checkTimeSpent(t.studentSubModuleProgress,s,s.required_time)?"success":"lighten"}},[t._v("\n                            mdi-check")])],1)],1)})),1)],1)})),1)],1)}),[],!1,null,"59a49615",null).exports}}]);