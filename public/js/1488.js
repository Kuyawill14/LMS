"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1488],{3349:(t,e,n)=>{n.d(e,{Z:()=>r});var i=n(1519),s=n.n(i)()((function(t){return t[1]}));s.push([t.id,".pannel-btn{position:absolute;right:47px;top:15px;z-index:100}.v-expansion-panel-content__wrap{padding:0!important}.course_content_header{align-items:center;display:flex}",""]);const r=s},1188:(t,e,n)=>{n.d(e,{Z:()=>r});var i=n(1519),s=n.n(i)()((function(t){return t[1]}));s.push([t.id,".v-list-item--disabled[data-v-1a26b542]{background:#f6f6f6}",""]);const r=s},1488:(t,e,n)=>{n.r(e),n.d(e,{default:()=>h});var i=n(7757),s=n.n(i);const r={};var o=n(1900);function u(t,e,n,i,s,r,o){try{var u=t[r](o),a=u.value}catch(t){return void n(t)}u.done?e(a):Promise.resolve(a).then(i,s)}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const d={props:["role","expand"],components:{dialogWarning:(0,o.Z)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{staticClass:"pa-3"},[n("div",{staticClass:"mb-3 pa-2"},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{staticClass:"text-center mb-0 pb-0",attrs:{cols:"12"}},[n("v-avatar",{attrs:{tile:"",size:"120"}},[n("v-img",{attrs:{src:"https://c.tenor.com/jFesPO4xs8kAAAAM/cat-watching-you.gif"}})],1)],1),t._v(" "),n("v-col",{staticClass:"text-center mt-0 pt-0",attrs:{cols:"12"}},[n("div",{staticClass:"primary--text display-1"},[t._v("Oops...")])])],1)],1),t._v(" "),n("v-card-text",[n("v-row",[n("v-col",{staticClass:"text-center"},[n("p",{staticClass:"body-1"},[t._v("\n                 You have leave the module's page. Your timer will be paused.\n              ")]),t._v(" "),n("v-btn",{staticClass:"ml-3 mr-3 mt-2",attrs:{color:"primary",rounded:"",large:""},on:{click:function(e){return t.$emit("toggleCloaseDialog")}}},[t._v("Confirm")])],1)],1)],1)],1)}),[],!1,null,null,null).exports},data:function(){return{click_id:null,loading:!0,temp_id:null,showLecture:!1,addLink:!1,showClasswork:!1,subModuleForm:{},mainModule_id:"",mainModule:[],studentSubModuleProgress:[],studentSubModuleProgressForm:{},timespent:0,time:!1,updateTime:!1,percentage:0,firstLoad:!1,warningDialog:!1,confirmWarning:!1,_mainModule_id:"",_subModule_id:""}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},(0,n(629).Se)(["getmain_module","getSub_module","getAll_sub_module","getStudentModuleProgress"])),methods:{subModuleClick:function(t,e,n,i,s){t||"Teacher"==this.role?(this.setTimeSpent(e,n,s),this.passToMainComponent(this.getSub_module(e),n),this.addSubStudentProgress(e,n,i,s)):this.toastInfo("Module not available, The instructor still not yet publish this module.")},passToMainComponent:function(t,e){var n=t.find((function(t){return t.id===e}));this.$emit("subModule",n)},student_sub_module_progress:function(t){},getCount:function(t,e){for(var n=0,i=this.getSub_module(e),s=0;s<i.length;s++)for(var r=0;r<t.length;r++)void 0!==t[r]&&void 0!==i[s]&&t[r].sub_module_id==i[s].id&&t[r].time_spent>=i[s].required_time&&n++;return n},addSubStudentProgress:function(t,e,n){var i=this;"Student"==this.role&&(this.tempSubId=e,this.studentSubModuleProgressForm.main_module_id=t,this.studentSubModuleProgressForm.sub_module_id=e,this.studentSubModuleProgressForm.type=n,this.studentSubModuleProgressForm.course_id=this.$route.params.id,axios.post("/api/student_sub_module/insert",{studentProgress:this.studentSubModuleProgressForm}).then((function(t){i.$store.dispatch("studentmodule_progress",i.$route.params.id),i.fetchStudentModuleProgress()})))},checkTimeSpent:function(t,e,n){for(var i=!1,s=0;s<t.length;s++)t[s].sub_module_id==e.id&&t[s].time_spent>=n&&(i=!0);return i},fetchClass:function(){this.$store.dispatch("fetchClassList").then((function(){}))},getTimeSpent:function(t,e){for(var n=0;n<t.length;n++)if(t[n].sub_module_id==e)return t[n].time_spent;return 0},convertTime:function(t,e){if(-1==e){var n=this.getTimeSpent(this.studentSubModuleProgress,t);return void 0===n&&(n=0),new Date(1e3*parseInt(n)).toISOString().substr(11,8)}return new Date(1e3*parseInt(e)).toISOString().substr(11,8)},setTimeSpent:function(t,e){var n=this;"Student"==this.role&&(this._mainModule_id=t,this._subModule_id=e,clearInterval(this.ctrTime),clearInterval(this.updateTime),this.timespent=this.getTimeSpent(this.studentSubModuleProgress,e),this.ctrTime=!1,this.updateTime=!1,this.ctrTime=setInterval((function(){n.timespent++,n.time=!0}),1e3),this.updateTime=setInterval((function(){n.updateStudentTimeProgress(t,e,n.timespent)}),2e3))},updateStudentTimeProgress:function(t,e,n){var i=this,s={};s.main_module_id=t,s.sub_module_id=e,s.time_spent=n;axios.post("/api/student_sub_module/updatetime",{studentProgress:s}).then((function(t){for(var e=t.data.studentProgress,n=0;n<i.studentSubModuleProgress.length;n++)if(i.studentSubModuleProgress[n].sub_module_id==e.sub_module_id){i.studentSubModuleProgress[n].time_spent=e.time_spent,i.$store.dispatch("studentmodule_progress",i.$route.params.id);break}}))},fetchStudentModuleProgress:function(){var t=this;axios.get("/api/student_sub_module/all/".concat(this.$route.params.id)).then((function(e){t.studentSubModuleProgress=e.data}))},confirmWarning_fn:function(){this.warningDialog=!this.warningDialog,(this.confirmWarning=!0)&&(console.log("continue the timer"),this.setTimeSpent(this._mainModule_id,this._subModule_id),this.confirmWarning=!1)},triggerWarning:function(){this.warningDialog=!0,this.confirmWarning=!1,clearInterval(this.ctrTime),clearInterval(this.updateTime)}},mounted:function(){var t,e=this;return(t=s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.fetchStudentModuleProgress(),e.$store.dispatch("fetchMainModule",e.$route.params.id),e.$store.dispatch("studentmodule_progress",e.$route.params.id),e.loading=!1,setTimeout((function(){e.firstLoad=!1}),5e3);case 5:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,s){var r=t.apply(e,n);function o(t){u(r,i,s,o,a,"next",t)}function a(t){u(r,i,s,o,a,"throw",t)}o(void 0)}))})()},created:function(){this.firstLoad=!0},beforeMount:function(){document.addEventListener("contextmenu",(function(t){t.preventDefault()})),window.addEventListener("onbeforeunload",this.preventNav);var t=this;$(window).blur((function(){$("iframe").is(":focus")||t.triggerWarning()}))},beforeDestroy:function(){clearInterval(this.ctrTime),clearInterval(this.updateTime)}};var c=n(2446),m=n.n(c),p=n(3349),g={insert:"head",singleton:!1};m()(p.Z,g);p.Z.locals;var v=n(1188),_={insert:"head",singleton:!1};m()(v.Z,_);v.Z.locals;const h=(0,o.Z)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{width:"100%"}},[n("v-dialog",{attrs:{persistent:"","max-width":"500"},model:{value:t.warningDialog,callback:function(e){t.warningDialog=e},expression:"warningDialog"}},[t.warningDialog?n("dialogWarning",{on:{toggleCloaseDialog:t.confirmWarning_fn}}):t._e()],1),t._v(" "),n("v-card",{staticClass:"mb-2"},[n("v-list-item",[n("v-list-item-content",[n("v-list-item-title",{staticClass:"course_content_header"},[t._v("\n                    Modules Content\n                    "),n("v-spacer"),t._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[n("v-progress-circular",t._g(t._b({staticClass:"float-right",attrs:{value:t.getStudentModuleProgress.percentage,rotate:-90,size:40,color:"green lighten-2"}},"v-progress-circular",s,!1),i),[n("span",[t._v(" "+t._s(t.getStudentModuleProgress.percentage))])])]}}])},[t._v(" "),n("span",[t._v(t._s(t.getStudentModuleProgress.completed)+" of\n                            "+t._s(t.getStudentModuleProgress.submodules_count)+" complete")])])],1)],1),t._v(" "),t.expand?n("v-list-item-action",[n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.$emit("listClose")}}},[n("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("mdi-close")])],1)],1):t._e()],1)],1),t._v(" "),n("v-expansion-panels",{staticStyle:{"margin-left":"1px"},attrs:{focusable:""}},t._l(t.getmain_module,(function(e,i){return n("v-expansion-panel",{key:"module"+i},[n("v-expansion-panel-header",[n("span",{staticStyle:{"font-size":"1.0rem"}},[n("v-icon",{staticStyle:{"font-size":"1.0rem"}},[t._v("\n                        mdi-folder\n                    ")]),t._v("\n                    "+t._s(e.module_name)+" "),n("br"),t._v("\n                    "+t._s(t.getCount(t.studentSubModuleProgress,e.id)+" / "+t.getSub_module(e.id).length)+"\n\n\n                ")],1)]),t._v(" "),n("v-expansion-panel-content",{staticClass:"pa-0"},t._l(t.getSub_module(e.id),(function(i,s){return n("v-list-item",{key:"Submodule"+s,staticClass:"pl-8",attrs:{link:"",disabled:t.click_id==i.id},on:{click:function(n){t.click_id=i.id,t.subModuleClick(e.isPublished,e.id,i.id,i.type,t.studentSubModuleProgress)}}},[n("v-list-item-avatar",[n("v-icon",{staticClass:"grey lighten-1",attrs:{dark:""}},[t._v("\n                            mdi-folder\n                        ")])],1),t._v(" "),n("v-list-item-content",[n("v-list-item-title",[t._v(" "+t._s(i.sub_module_name))]),t._v(" "),n("v-list-item-subtitle",[t._v(" "+t._s(i.type))]),t._v(" "),n("v-list-item-subtitle",[t._v(" Time spent:\n                            "+t._s(t.convertTime(i.id,-1))+"\n\n                        ")]),t._v(" "),n("v-list-item-subtitle",[t._v(" Required time:\n                            "+t._s(t.convertTime(-1,i.required_time))+"\n\n                        ")])],1),t._v(" "),n("v-list-item-action",[n("v-icon",{attrs:{color:t.checkTimeSpent(t.studentSubModuleProgress,i,i.required_time)?"success":"lighten"}},[t._v("\n                            mdi-check")])],1)],1)})),1)],1)})),1)],1)}),[],!1,null,"1a26b542",null).exports}}]);