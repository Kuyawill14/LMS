"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5129],{38893:(t,n,e)=>{e.d(n,{Z:()=>s});var i=e(1519),a=e.n(i)()((function(t){return t[1]}));a.push([t.id,".AnnoumentEditor>.quill-editor{background:#d0cece;position:relative}.AnnoumentEditor>.ql-container.ql-snow{border:none!important}.AnnoumentEditor>.ql-toolbar.ql-snow{background:#f2f2f2;border:none}.AnnoumentEditor>.ql-bold,.ql-align,.ql-image,.ql-italic,.ql-link,.ql-list,.ql-picker-label,.ql-strike,.ql-underline,.ql-video{border:none!important;outline:none!important}.AnnoumentEditor>.ql-tooltip,.ql-editing{z-index:1}.AnnoumentEditor>iframe{height:20rem!important;width:100%!important}.AnnoumentEditor>.ql-editor img{max-height:25rem!important}.AnnoumentEditor>.ql-container{max-height:70rem}",""]);const s=a},65129:(t,n,e)=>{e.r(n),e.d(n,{default:()=>p});var i,a=e(87757),s=e.n(a);function o(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function r(t,n,e,i,a,s,o){try{var r=t[s](o),l=r.value}catch(t){return void e(t)}r.done?n(l):Promise.resolve(l).then(i,a)}function l(t){return function(){var n=this,e=arguments;return new Promise((function(i,a){var s=t.apply(n,e);function o(t){r(s,i,a,o,l,"next",t)}function l(t){r(s,i,a,o,l,"throw",t)}o(void 0)}))}}const c={props:["UserDetails","classNames"],data:function(){return{isLoadingClassNames:!0,isLoaded:!1,notifyDetails:{},selectedFile:null,isSelecting:!1,isloading:!1,value:"",content:"",class_id:this.$route.params.id,announcement:{content:"",file:"",class_id:""},options:{modules:{toolbar:{container:[["bold","italic","underline"],[{header:[1,2,3,4,5,!1]}],[{color:[]}],[{list:"ordered"},{list:"bullet"}],["link","image","video"]],handlers:{image:this.imageHandler}}}},pasteText:!0,editorData:null}},computed:{buttonText:function(){return this.selectedFile?this.selectedFile.name:this.defaultButtonText}},methods:(i={val:function(){this.value="This's new value"},onChange:function(t,n){},createPost:function(){var t=this;""!=this.announcement.content&&(this.isloading=!0,this.announcement.file="sample",this.announcement.course_id=this.$route.params.id==this.class_id?this.$route.params.id:null,this.announcement.class_id=this.$route.params.id!=this.class_id?this.class_id:null,this.announcement.content=this.announcement.content.replaceAll("p>","div>"),this.$store.dispatch("createClassPost",this.announcement).then((function(n){200==n.status?(t.isloading=!1,t.newNotification(n.data.announcement_id)):t.isloading=!1})),this.announcement.content="",this.$emit("SetShowComment"))},onButtonClick:function(){var t=this;this.isSelecting=!0,window.addEventListener("focus",(function(){t.isSelecting=!1}),{once:!0}),this.$refs.uploader.click()},onFileChanged:function(t){this.selectedFile=t.target.files[0]},onEditorBlur:function(t){this.editorData=t},onEditorFocus:function(t){this.editorData=t},onEditorReady:function(t){this.editorData=t},imageHandler:function(){var t=this.editorData,n=document.createElement("input");n.setAttribute("type","file"),n.setAttribute("accept","image/*"),n.click(),n.onchange=l(s().mark((function e(){var i,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.files[0],(a=new FormData).append("file",i),a.append("type","Announcement"),o=t.getSelection(!0),t.setSelection(o.index+1),e.next=8,axios.post("/api/classwork/newAttachment",a).then(function(){var n=l(s().mark((function n(e){var i;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.data,n.next=3,t.insertEmbed(o.index,"image",i.link);case 3:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).catch((function(t){t.response;alert("error")}));case 8:case"end":return e.stop()}}),e)})))}},o(i,"onChange",(function(t,n,e){})),o(i,"fetchClassnames",(function(){var t=this;"Teacher"==this.UserDetails.role&&axios.get("/api/class/allnames/"+this.$route.params.id+"/0").then((function(n){t.classNames=n.data,t.isLoadingClassNames=!1,t.isLoaded=!0,t.classNames.push({class_id:t.$route.params.id,class_name:"All Class",id:t.$route.params.id})}))})),o(i,"newNotification",(function(t){var n=this;return l(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.notifyDetails.class_id=n.$route.params.id!=n.class_id?n.class_id:null,n.notifyDetails.course_id=n.$route.params.id==n.class_id?n.$route.params.id:null,n.notifyDetails.course_find_id=n.$route.params.id,n.notifyDetails.announcement_id=t,n.notifyDetails.type="announcement",axios.post("/api/notification/new",n.notifyDetails);case 6:case"end":return e.stop()}}),e)})))()})),i)};var u=e(72446),d=e.n(u),m=e(38893),h={insert:"head",singleton:!1};d()(m.Z,h);m.Z.locals;const p=(0,e(51900).Z)(c,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("vue-element-loading",{attrs:{active:t.isloading,spinner:"bar-fade-scale"}}),t._v(" "),e("editor",{staticClass:"AnnoumentEditor",attrs:{placeholder:"Announce something in your class!",theme:"snow",options:t.options},on:{blur:function(n){return t.onEditorBlur(n)},focus:function(n){return t.onEditorFocus(n)},ready:function(n){return t.onEditorReady(n)},change:t.onChange},model:{value:t.announcement.content,callback:function(n){t.$set(t.announcement,"content",n)},expression:"announcement.content"}}),t._v(" "),e("v-row",{staticClass:"pl-3 pr-3"},[e("v-col",{attrs:{cols:"5",md:"8",lg:"8"}}),t._v(" "),e("v-col",{staticClass:"text-right",attrs:{cols:"7",md:"4",lg:"4"}},[e("v-container",{class:"Student"!=t.UserDetails.role?"ma-0 pa-0 d-flex flex-row":"ma-0 pa-0",attrs:{"ma-0":"","pa-0":""}},["Student"!=t.UserDetails.role?e("v-select",{staticClass:"mr-2 ma-0 pa-0",attrs:{"hide-details":"",items:t.classNames,"item-text":"class_name","item-value":"class_id",label:"All Class",dense:"",solo:""},model:{value:t.class_id,callback:function(n){t.class_id=n},expression:"class_id"}}):t._e(),t._v(" "),e("v-btn",{staticClass:"mb-0 pb-0",attrs:{depressed:"",disabled:""==t.announcement.content||null==t.announcement.content,type:"submit",name:"create_post",color:"primary"},on:{click:t.createPost}},[t._v("Post")])],1)],1)],1)],1)}),[],!1,null,null,null).exports}}]);