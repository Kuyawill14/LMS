"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1012],{3349:(t,e,s)=>{s.d(e,{Z:()=>r});var n=s(1519),i=s.n(n)()((function(t){return t[1]}));i.push([t.id,".pannel-btn{position:absolute;right:47px;top:15px;z-index:100}.v-expansion-panel-content__wrap{padding:0!important}.course_content_header{align-items:center;display:flex}",""]);const r=i},2720:(t,e,s)=>{s.d(e,{Z:()=>r});var n=s(1519),i=s.n(n)()((function(t){return t[1]}));i.push([t.id,".v-list-item--disabled[data-v-864c47f4]{background:#f6f6f6}",""]);const r=i},1012:(t,e,s)=>{s.r(e),s.d(e,{default:()=>_});var n=s(7757),i=s.n(n);function r(t,e,s,n,i,r,o){try{var u=t[r](o),d=u.value}catch(t){return void s(t)}u.done?e(d):Promise.resolve(d).then(n,i)}function o(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function u(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const d={props:["role","expand"],components:{},data:function(){return{click_id:null,loading:!0,temp_id:null,showLecture:!1,addLink:!1,showClasswork:!1,subModuleForm:{},mainModule_id:"",mainModule:[],studentSubModuleProgress:[],studentSubModuleProgressForm:{},timespent:0,time:!1,updateTime:!1,percentage:0,firstLoad:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(e){u(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},(0,s(629).Se)(["getmain_module","getSub_module","getAll_sub_module","getStudentModuleProgress"])),methods:{subModuleClick:function(t,e,s,n,i){t||"Teacher"==this.role?(this.setTimeSpent(e,s,i),this.passToMainComponent(this.getSub_module(e),s),this.addSubStudentProgress(e,s,n,i)):this.toastInfo("Module not available, The instructor still not yet publish this module.")},passToMainComponent:function(t,e){var s=t.find((function(t){return t.id===e}));this.$emit("subModule",s)},student_sub_module_progress:function(t){},getCount:function(t,e){for(var s=0,n=this.getSub_module(e),i=0;i<n.length;i++)for(var r=0;r<t.length;r++)void 0!==t[r]&&void 0!==n[i]&&t[r].sub_module_id==n[i].id&&t[r].time_spent>=n[i].required_time&&s++;return s},addSubStudentProgress:function(t,e,s){var n=this;"Student"==this.role&&(this.tempSubId=e,this.studentSubModuleProgressForm.main_module_id=t,this.studentSubModuleProgressForm.sub_module_id=e,this.studentSubModuleProgressForm.type=s,this.studentSubModuleProgressForm.course_id=this.$route.params.id,axios.post("/api/student_sub_module/insert",{studentProgress:this.studentSubModuleProgressForm}).then((function(t){n.$store.dispatch("studentmodule_progress",n.$route.params.id),n.$store.dispatch("fetchClassList"),n.fetchStudentModuleProgress()})))},checkTimeSpent:function(t,e,s){for(var n=!1,i=0;i<t.length;i++)t[i].sub_module_id==e.id&&t[i].time_spent>=s&&(n=!0);return n},fetchClass:function(){this.$store.dispatch("fetchClassList").then((function(){}))},getTimeSpent:function(t,e){for(var s=0;s<t.length;s++)if(t[s].sub_module_id==e)return t[s].time_spent;return 0},convertTime:function(t,e){if(-1==e){var s=this.getTimeSpent(this.studentSubModuleProgress,t);return void 0===s&&(s=0),new Date(1e3*parseInt(s)).toISOString().substr(11,8)}return new Date(1e3*parseInt(e)).toISOString().substr(11,8)},setTimeSpent:function(t,e,s){var n=this;"Student"==this.role&&(clearInterval(this.ctrTime),clearInterval(this.updateTime),this.timespent=this.getTimeSpent(this.studentSubModuleProgress,e),this.ctrTime=!1,this.updateTime=!1,this.ctrTime=setInterval((function(){n.timespent++,n.time=!0}),1e3),this.updateTime=setInterval((function(){n.updateStudentTimeProgress(t,e,n.timespent)}),3e3))},updateStudentTimeProgress:function(t,e,s){var n=this,i={};i.main_module_id=t,i.sub_module_id=e,i.time_spent=s;axios.post("/api/student_sub_module/updatetime",{studentProgress:i}).then((function(t){for(var e=t.data.studentProgress,s=0;s<n.studentSubModuleProgress.length;s++)if(n.studentSubModuleProgress[s].sub_module_id==e.sub_module_id){n.studentSubModuleProgress[s].time_spent=e.time_spent,n.$store.dispatch("studentmodule_progress",n.$route.params.id),n.$store.dispatch("fetchClassList");break}}))},fetchStudentModuleProgress:function(){var t=this;axios.get("/api/student_sub_module/all/".concat(this.$route.params.id)).then((function(e){t.studentSubModuleProgress=e.data}))}},mounted:function(){var t,e=this;return(t=i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.fetchClass(),e.fetchStudentModuleProgress(),e.$store.dispatch("fetchMainModule",e.$route.params.id),e.$store.dispatch("fetchSubModule",e.$route.params.id),e.$store.dispatch("studentmodule_progress",e.$route.params.id),e.loading=!1,setTimeout((function(){e.firstLoad=!1}),5e3);case 7:case"end":return t.stop()}}),t)})),function(){var e=this,s=arguments;return new Promise((function(n,i){var o=t.apply(e,s);function u(t){r(o,n,i,u,d,"next",t)}function d(t){r(o,n,i,u,d,"throw",t)}u(void 0)}))})()},created:function(){this.firstLoad=!0},beforeDestroy:function(){clearInterval(this.ctrTime),clearInterval(this.updateTime)}};var a=s(2446),l=s.n(a),c=s(3349),m={insert:"head",singleton:!1};l()(c.Z,m);c.Z.locals;var p=s(2720),h={insert:"head",singleton:!1};l()(p.Z,h);p.Z.locals;const _=(0,s(1900).Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{width:"100%"}},[s("v-card",{staticClass:"mb-2"},[s("v-list-item",[s("v-list-item-content",[s("v-list-item-title",{staticClass:"course_content_header"},[t._v("\n                    Modules Content\n                    "),s("v-spacer"),t._v(" "),s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,i=e.attrs;return[s("v-progress-circular",t._g(t._b({staticClass:"float-right",attrs:{value:t.getStudentModuleProgress.percentage,rotate:-90,size:40,color:"green lighten-2"}},"v-progress-circular",i,!1),n),[s("span",[t._v(" "+t._s(t.getStudentModuleProgress.percentage))])])]}}])},[t._v(" "),s("span",[t._v(t._s(t.getStudentModuleProgress.completed)+" of\n                            "+t._s(t.getStudentModuleProgress.submodules_count)+" complete")])])],1)],1),t._v(" "),t.expand?s("v-list-item-action",[s("v-btn",{attrs:{icon:""},on:{click:function(e){return t.$emit("listClose")}}},[s("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("mdi-close")])],1)],1):t._e()],1)],1),t._v(" "),s("v-expansion-panels",{staticStyle:{"margin-left":"1px"},attrs:{focusable:""}},t._l(t.getmain_module,(function(e,n){return s("v-expansion-panel",{key:"module"+n},[s("v-expansion-panel-header",[s("span",{staticStyle:{"font-size":"1.0rem"}},[s("v-icon",{staticStyle:{"font-size":"1.0rem"}},[t._v("\n                        mdi-folder\n                    ")]),t._v("\n                    "+t._s(e.module_name)+" "),s("br"),t._v("\n                    "+t._s(t.getCount(t.studentSubModuleProgress,e.id)+" / "+t.getSub_module(e.id).length)+"\n\n\n                ")],1)]),t._v(" "),s("v-expansion-panel-content",{staticClass:"pa-0"},t._l(t.getSub_module(e.id),(function(n,i){return s("v-list-item",{key:"Submodule"+i,staticClass:"pl-8",attrs:{link:"",disabled:t.click_id==n.id},on:{click:function(s){t.click_id=n.id,t.subModuleClick(e.isPublished,e.id,n.id,n.type,t.studentSubModuleProgress)}}},[s("v-list-item-avatar",[s("v-icon",{staticClass:"grey lighten-1",attrs:{dark:""}},[t._v("\n                            mdi-folder\n                        ")])],1),t._v(" "),s("v-list-item-content",[s("v-list-item-title",[t._v(" "+t._s(n.sub_module_name))]),t._v(" "),s("v-list-item-subtitle",[t._v(" "+t._s(n.type))]),t._v(" "),s("v-list-item-subtitle",[t._v(" Time spent:\n                            "+t._s(t.convertTime(n.id,-1))+"\n\n                        ")]),t._v(" "),s("v-list-item-subtitle",[t._v(" Required time:\n                            "+t._s(t.convertTime(-1,n.required_time))+"\n\n                        ")])],1),t._v(" "),s("v-list-item-action",[s("v-icon",{attrs:{color:t.checkTimeSpent(t.studentSubModuleProgress,n,n.required_time)?"success":"lighten"}},[t._v("\n                            mdi-check")])],1)],1)})),1)],1)})),1)],1)}),[],!1,null,"864c47f4",null).exports}}]);