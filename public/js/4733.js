"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4733],{38893:(t,e,n)=>{n.d(e,{Z:()=>s});var i=n(1519),a=n.n(i)()((function(t){return t[1]}));a.push([t.id,".AnnoumentEditor>.quill-editor{background:#d0cece;position:relative}.AnnoumentEditor>.ql-container.ql-snow{border:none!important}.AnnoumentEditor>.ql-toolbar.ql-snow{background:#f2f2f2;border:none}.AnnoumentEditor>.ql-bold,.ql-align,.ql-image,.ql-italic,.ql-link,.ql-list,.ql-picker-label,.ql-strike,.ql-underline,.ql-video{border:none!important;outline:none!important}.AnnoumentEditor>.ql-tooltip,.ql-editing{z-index:1}.AnnoumentEditor>iframe{height:20rem!important;width:100%!important}.AnnoumentEditor>.ql-editor img{max-height:25rem!important}.AnnoumentEditor>.ql-container{max-height:70rem}",""]);const s=a},74733:(t,e,n)=>{n.r(e),n.d(e,{default:()=>p});var i,a=n(87757),s=n.n(a);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e,n,i,a,s,o){try{var r=t[s](o),l=r.value}catch(t){return void n(t)}r.done?e(l):Promise.resolve(l).then(i,a)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var s=t.apply(e,n);function o(t){r(s,i,a,o,l,"next",t)}function l(t){r(s,i,a,o,l,"throw",t)}o(void 0)}))}}const c={props:["UserDetails","classNames"],data:function(){return{isLoadingClassNames:!0,isLoaded:!1,notifyDetails:{},selectedFile:null,isSelecting:!1,isloading:!1,value:"",content:"",class_id:this.$route.params.id,announcement:{content:"",file:"",class_id:""},options:{modules:{toolbar:{container:[["bold","italic","underline"],[{header:[1,2,3,4,5,!1]}],[{color:[]}],[{list:"ordered"},{list:"bullet"}],["link","image","video"]],handlers:{image:this.imageHandler}}}},pasteText:!0,editorData:null}},computed:{buttonText:function(){return this.selectedFile?this.selectedFile.name:this.defaultButtonText}},methods:(i={val:function(){this.value="This's new value"},onChange:function(t,e){},createPost:function(){var t=this;""!=this.announcement.content&&(this.isloading=!0,this.announcement.file="sample",this.announcement.course_id=this.$route.params.id==this.class_id?this.$route.params.id:null,this.announcement.class_id=this.$route.params.id!=this.class_id?this.class_id:null,this.announcement.content=this.announcement.content.replaceAll("p>","div>"),this.$store.dispatch("createClassPost",this.announcement).then((function(e){200==e.status?(t.isloading=!1,t.newNotification(e.data.announcement_id)):t.isloading=!1})),this.announcement.content="",this.$emit("SetShowComment"))},onButtonClick:function(){var t=this;this.isSelecting=!0,window.addEventListener("focus",(function(){t.isSelecting=!1}),{once:!0}),this.$refs.uploader.click()},onFileChanged:function(t){this.selectedFile=t.target.files[0]},onEditorBlur:function(t){this.editorData=t},onEditorFocus:function(t){this.editorData=t},onEditorReady:function(t){this.editorData=t},imageHandler:function(){var t=this.editorData,e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.click(),e.onchange=l(s().mark((function n(){var i,a,o;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.files[0],(a=new FormData).append("file",i),a.append("type","Announcement"),o=t.getSelection(!0),t.setSelection(o.index+1),n.next=8,axios.post("/api/classwork/newAttachment",a).then(function(){var e=l(s().mark((function e(n){var i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.data,e.next=3,t.insertEmbed(o.index,"image",i.link);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(t){t.response;alert("error")}));case 8:case"end":return n.stop()}}),n)})))}},o(i,"onChange",(function(t,e,n){})),o(i,"fetchClassnames",(function(){var t=this;"Teacher"==this.UserDetails.role&&axios.get("/api/class/allnames/"+this.$route.params.id+"/0").then((function(e){t.classNames=e.data,t.isLoadingClassNames=!1,t.isLoaded=!0,t.classNames.push({class_id:t.$route.params.id,class_name:"All Class",id:t.$route.params.id})}))})),o(i,"newNotification",(function(t){var e=this;return l(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.notifyDetails.class_id=e.$route.params.id!=e.class_id?e.class_id:null,e.notifyDetails.course_id=e.$route.params.id==e.class_id?e.$route.params.id:null,e.notifyDetails.course_find_id=e.$route.params.id,e.notifyDetails.announcement_id=t,e.notifyDetails.type="announcement",axios.post("/api/notification/new",e.notifyDetails);case 6:case"end":return n.stop()}}),n)})))()})),i)};var u=n(72446),d=n.n(u),m=n(38893),h={insert:"head",singleton:!1};d()(m.Z,h);m.Z.locals;const p=(0,n(51900).Z)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("vue-element-loading",{attrs:{active:t.isloading,spinner:"bar-fade-scale"}}),t._v(" "),n("editor",{staticClass:"AnnoumentEditor",attrs:{placeholder:"Announce something in your class!",theme:"snow",options:t.options},on:{blur:function(e){return t.onEditorBlur(e)},focus:function(e){return t.onEditorFocus(e)},ready:function(e){return t.onEditorReady(e)},change:t.onChange},model:{value:t.announcement.content,callback:function(e){t.$set(t.announcement,"content",e)},expression:"announcement.content"}}),t._v(" "),n("v-row",{staticClass:"pl-3 pr-3"},[n("v-col",{attrs:{cols:"5",md:"8",lg:"8"}}),t._v(" "),n("v-col",{staticClass:"text-right",attrs:{cols:"7",md:"4",lg:"4"}},[n("v-container",{class:"Student"!=t.UserDetails.role?"ma-0 pa-0 d-flex flex-row":"ma-0 pa-0",attrs:{"ma-0":"","pa-0":""}},["Student"!=t.UserDetails.role?n("v-select",{staticClass:"mr-2 ma-0 pa-0",attrs:{items:t.classNames,"item-text":"class_name","item-value":"class_id",label:"All Class",dense:"",solo:""},model:{value:t.class_id,callback:function(e){t.class_id=e},expression:"class_id"}}):t._e(),t._v(" "),n("v-btn",{attrs:{depressed:"",type:"submit",name:"create_post",color:"primary"},on:{click:t.createPost}},[t._v("Post")])],1)],1)],1)],1)}),[],!1,null,null,null).exports}}]);