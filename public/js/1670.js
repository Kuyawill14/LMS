(self.webpackChunk=self.webpackChunk||[]).push([[1670],{358:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>a});var s=n(3645),i=n.n(s)()((function(t){return t[1]}));i.push([t.id,".ql-align,.ql-bold,.ql-image,.ql-italic,.ql-link,.ql-list,.ql-picker-label,.ql-strike,.ql-underline,.ql-video{outline:none!important;border:none!important}.ql-editing,.ql-tooltip{z-index:1}iframe{width:100%!important;height:20rem!important}.ql-editor img{max-height:25rem!important}.ql-container{max-height:70rem}",""]);const a=i},1670:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>l});var s=n(7757),i=n.n(s);function a(t,e,n,s,i,a,o){try{var l=t[a](o),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(s,i)}const o={props:["UserDetails","classNames"],data:function(){return{isLoadingClassNames:!0,isLoaded:!1,notifyDetails:{},selectedFile:null,isSelecting:!1,isEditing:!1,isloading:!1,value:"",content:"",class_id:this.$route.params.id,announcement:{content:"",file:"",class_id:""},options:{modules:{toolbar:[["bold","italic","underline","strike"],[{header:[1,2,3,4,5,!1]}],[{align:[]}],[{color:[]}],[{list:"ordered"},{list:"bullet"}],["link","image","video"]]}}}},computed:{buttonText:function(){return this.selectedFile?this.selectedFile.name:this.defaultButtonText}},methods:{val:function(){this.value="This's new value"},onChange:function(t,e){console.log(t.length,e.length)},createPost:function(){var t=this;""!=this.announcement.content&&(this.isloading=!0,this.announcement.file="sample",this.announcement.course_id=this.$route.params.id,this.announcement.class_id=this.class_id,this.announcement.content=this.announcement.content.replaceAll("p>","div>"),this.$store.dispatch("createClassPost",this.announcement).then((function(e){200==e.status?(t.isloading=!1,t.newNotification(e.data.announcement_id)):t.isloading=!1})),this.announcement.content="",this.$emit("SetShowComment"))},onButtonClick:function(){var t=this;this.isSelecting=!0,window.addEventListener("focus",(function(){t.isSelecting=!1}),{once:!0}),this.$refs.uploader.click()},onFileChanged:function(t){this.selectedFile=t.target.files[0]},fetchClassnames:function(){var t=this;"Teacher"==this.UserDetails.role&&axios.get("/api/class/allnames/"+this.$route.params.id+"/0").then((function(e){t.classNames=e.data,t.isLoadingClassNames=!1,t.isLoaded=!0,t.classNames.push({class_id:t.$route.params.id,class_name:"All Class",id:t.$route.params.id})}))},testing:function(){console.log(this.class_id)},newNotification:function(t){var e,n=this;return(e=i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.notifyDetails.class_id=n.class_id,n.notifyDetails.course_id=n.$route.params.id,n.notifyDetails.announcement_id=t,n.notifyDetails.type="announcement",axios.post("/api/notification/new",n.notifyDetails);case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(s,i){var o=e.apply(t,n);function l(t){a(o,s,i,l,c,"next",t)}function c(t){a(o,s,i,l,c,"throw",t)}l(void 0)}))})()}}};n(1285);const l=(0,n(1900).Z)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("vue-element-loading",{attrs:{active:t.isloading,spinner:"bar-fade-scale"}}),t._v(" "),n("editor",{staticStyle:{outline:"none"},attrs:{placeholder:"Announce something in your class!",theme:"snow",options:t.options},on:{change:function(e){t.isEditing=!0,t.fetchClassnames}},model:{value:t.announcement.content,callback:function(e){t.$set(t.announcement,"content",e)},expression:"announcement.content"}}),t._v(" "),n("v-expand-transition",[0!=t.announcement.content.length?n("v-row",{staticClass:"pl-3 pr-3 pb-1"},[n("v-col",{attrs:{cols:"6",md:"8",lg:"8"}},[n("v-container",{staticClass:"ma-0 pa-0 d-flex flex-row",attrs:{"ma-0":"","pa-0":""}},[n("v-btn",{staticClass:"text-none",attrs:{depressed:"",loading:t.isSelecting},on:{click:t.onButtonClick}},[n("v-icon",{attrs:{left:""}},[t._v("\n                        cloud_upload\n                        ")]),t._v("\n                        "+t._s(t.$vuetify.breakpoint.xs?"":"Upload file")+"\n                    ")],1),t._v(" "),n("input",{ref:"uploader",staticClass:"d-none",attrs:{name:"file",type:"file",accept:"image/*"},on:{change:t.onFileChanged}})],1)],1),t._v(" "),n("v-col",{staticClass:"text-right",attrs:{cols:"6",md:"4",lg:"4"}},[n("v-container",{class:"Student"!=t.UserDetails.role?"ma-0 pa-0 d-flex flex-row":"ma-0 pa-0",attrs:{"ma-0":"","pa-0":""}},["Student"!=t.UserDetails.role?n("v-select",{staticClass:"mr-2",attrs:{items:t.classNames,"item-text":"class_name","item-value":"class_id",label:"All Class",dense:"",solo:""},on:{change:function(e){return t.testing()}},model:{value:t.class_id,callback:function(e){t.class_id=e},expression:"class_id"}}):t._e(),t._v(" "),n("v-btn",{attrs:{depressed:"",type:"submit",name:"create_post",color:"primary"},on:{click:t.createPost}},[t._v("Post")])],1)],1)],1):t._e()],1)],1)}),[],!1,null,null,null).exports},1285:(t,e,n)=>{var s=n(358);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[t.id,s,""]]),s.locals&&(t.exports=s.locals);(0,n(5346).Z)("62c7b86c",s,!0,{})}}]);